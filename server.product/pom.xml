<?xml version="1.0" encoding="UTF-8"?>

<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">  
    <modelVersion>4.0.0</modelVersion>  
    <artifactId>server.product</artifactId>  
    <name>GitPlex</name>
    <parent> 
        <groupId>com.gitplex</groupId>  
        <artifactId>server</artifactId>  
        <version>1.0-EAP-build4</version> 
    </parent>  
    <build> 
        <plugins> 
            <plugin> 
                <artifactId>maven-archetype-plugin</artifactId> 
            </plugin>  
            <plugin> 
                <artifactId>maven-source-plugin</artifactId> 
            </plugin>  
            <plugin> 
                <artifactId>maven-javadoc-plugin</artifactId> 
            </plugin>  
        	<plugin>
	            <groupId>org.codehaus.groovy.maven</groupId>
	            <artifactId>gmaven-plugin</artifactId>
	            <version>1.0</version>
	            <executions>
	                <execution>
	                    <phase>initialize</phase>
	                    <goals>
	                        <goal>execute</goal>
	                  </goals>
	                   <configuration>
	                      <source>
	                      project.properties["lowerCaseProductName"] = project.name.toLowerCase() 
	                     </source>
	                 </configuration>
	             </execution>
	          </executions>
	     	</plugin>
			<plugin> 
                <groupId>com.gitplex</groupId>  
                <artifactId>plugin.maven</artifactId>  
                <executions> 
                    <execution> 
                        <id>copy-product-resources</id>  
                        <phase>compile</phase>  
                        <goals> 
                            <goal>run-ant</goal> 
                        </goals>  
                        <configuration> 
                            <target> 
                                <copy todir="${project.build.directory}/sandbox"> 
                                    <fileset dir="system" excludes="site/images/**, site/avatars/**, **/*.keystore, **/*.jar"/>  
                                    <filterset> 
                                        <filter token="productName" value="${lowerCaseProductName}"/> 
                                    </filterset> 
                                </copy>  
                                <copy todir="${project.build.directory}/sandbox"> 
                                    <fileset dir="system" includes="site/images/**, site/avatars/**, **/*.keystore, **/*.jar"/> 
                                </copy> 
                            </target> 
                        </configuration> 
                    </execution> 
                </executions> 
            </plugin>  
            <plugin> 
                <artifactId>maven-antrun-plugin</artifactId>  
                <executions> 
                    <execution> 
                        <id>prepare-package</id>  
                        <phase>prepare-package</phase>  
                        <goals> 
                            <goal>run</goal> 
                        </goals>  
                        <configuration> 
                            <target> 
                                <taskdef name="gant" classname="org.codehaus.gant.ant.Gant"/>  
                                <gant file="build/prepare_package.gant"> 
                                    <definition name="buildDirectory" value="${project.build.directory}"/>  
                                    <definition name="outputDirectory" value="${project.build.outputDirectory}"/>  
                                    <definition name="jswPath" value="${com.gitplex:commons.jsw:jar}"/>  
                                    <definition name="productName" value="${lowerCaseProductName}"/>  
                                    <definition name="productDescription" value="${project.name}"/>  
                                    <definition name="bootstrapClass" value="${bootstrapClass}"/> 
                                </gant> 
                            </target> 
                        </configuration> 
                    </execution>  
                    <execution> 
                        <id>package</id>  
                        <phase>package</phase>  
                        <goals> 
                            <goal>run</goal> 
                        </goals>  
                        <configuration> 
                            <target> 
                                <taskdef name="gant" classname="org.codehaus.gant.ant.Gant"/>  
                                <gant file="build/package.gant"> 
                                    <definition name="buildDirectory" value="${project.build.directory}"/>  
                                    <definition name="executables" value="${executables}"/>  
                                    <definition name="packageName" value="${lowerCaseProductName}-${project.version}"/> 
                                </gant> 
                            </target> 
                        </configuration> 
                    </execution> 
                </executions> 
            </plugin> 
        </plugins> 
    </build>  
    <dependencies> 
        <dependency> 
            <groupId>com.gitplex</groupId>  
            <artifactId>commons.jsw</artifactId>  
            <version>1.0.0</version>  
            <scope>provided</scope> 
        </dependency>  
        <dependency> 
            <groupId>com.gitplex</groupId>  
            <artifactId>server.core</artifactId>  
            <version>1.0-EAP-build4</version> 
        </dependency>  
        <dependency> 
            <groupId>com.gitplex</groupId>  
            <artifactId>server.web</artifactId>  
            <version>1.0-EAP-build4</version> 
        </dependency>  
        <dependency> 
            <groupId>com.gitplex</groupId>  
            <artifactId>commons.loader</artifactId>  
            <version>1.0.0</version>  
            <type>test-jar</type>  
            <scope>test</scope> 
        </dependency>  
        <dependency> 
            <groupId>com.gitplex</groupId>  
            <artifactId>commons.git</artifactId>  
            <version>1.0.0</version>  
            <type>test-jar</type>  
            <scope>test</scope> 
        </dependency>  
        <dependency> 
            <groupId>com.gitplex</groupId>  
            <artifactId>server.rest</artifactId>  
            <version>1.0-EAP-build4</version> 
        </dependency>  
        <dependency> 
            <groupId>com.gitplex</groupId>  
            <artifactId>server.http</artifactId>  
            <version>1.0-EAP-build4</version> 
        </dependency>  
        <dependency> 
            <groupId>com.gitplex</groupId>  
            <artifactId>server.search</artifactId>  
            <version>1.0-EAP-build4</version> 
        </dependency> 
    </dependencies>  
    <repositories> 
        <repository> 
            <id>gitplexRepo</id>  
            <name>GitPlex Repository</name>  
            <releases> 
                <enabled>true</enabled>  
                <updatePolicy>never</updatePolicy>  
                <checksumPolicy>fail</checksumPolicy> 
            </releases>  
            <snapshots> 
                <enabled>true</enabled>  
                <updatePolicy>always</updatePolicy>  
                <checksumPolicy>fail</checksumPolicy> 
            </snapshots>  
            <url>http://artifact.gitplex.com/</url> 
        </repository> 
    </repositories>  
    <properties> 
        <executables>bin/*.sh, boot/wrapper-*</executables>  
        <bootstrapClass>com.gitplex.commons.bootstrap.Bootstrap</bootstrapClass>  
        <moduleClass>com.gitplex.server.product.ProductModule</moduleClass>  
        <aggregation>true</aggregation> 
    </properties>   
</project>
